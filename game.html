<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="gamestyle.css">
    </head>
    <header id="buttonSpace">
        <button onclick="pickSize()">Start</button>
        <form action="game_rdbms.php"><input type="submit" value="Quit"></form>
    </header>
    <body>
        <section id="currplayer"></section>
        <section id="tablespace">
        </section>

        <script>
            var currentplayer = 1;
            var gameStart = false;

            const tablePos = []; //index of positions
            const tableValues = []; //moves made based on index

            const gameboard = [];

            var GAMEROWS;
            var GAMECOL;

            var space = document.getElementById("tablespace");

            var One = new player()

            function checkID(the_id){
                console.log(the_id);
            }

            function checkColumn(the_id){
                let num = String(the_id);
                let val = num[1];
                console.log("Column number = " + val);
            }

            function findOpenRow(the_id){
                console.log(the_id);
                var row = the_id[1];
                var col = the_id[4];
                let columnStats = [];

                for(let i = 0; i < GAMEROWS; i++){ //looks at if column is filled
                    let temp = document.getElementById("["+i+"]["+col+"]");
                    if (temp.hasChildNodes() == false){
                        columnStats.push('0');
                    }else{
                        columnStats.push('1');
                    }
                }
                for(let j = columnStats.length - 1; j >= 0; j--){
                    console.log(columnStats[j] == String(0));
                    if(columnStats[j] === String(0)){
                        if(columnStats[j+1] === String(0)){
                            continue;
                        }else{
                            placePiece("["+j+"]["+col+"]");
                            return;
                        }
                    }
                }
                
            }

            function placePiece(the_id){
                checkID(the_id);
                checkColumn(the_id);
                let x = document.getElementById(the_id);

                if(currentplayer == 1){
                    y = document.createElement("div");
                    y.setAttribute("class", "coin");
                    x.appendChild(y);
                    currentplayer = 0;
                }else{
                    y = document.createElement("div");
                    y.setAttribute("class", "coin2");
                    x.appendChild(y);
                    currentplayer = 1
                }
                setplayer();
            }

            function setplayer(){
                if(gameStart == false){
                    currentplayer = Math.random() % 2;
                    gameStart = true;
                }
                var playerspace = document.getElementById("currplayer");
                if(currentplayer == 1){
                    playerspace.innerHTML = "Go Player 1";
                }else{
                    playerspace.innerHTML = "Go Player 2";
                }
            }

            function pickSize(){
                var place = document.getElementById("buttonSpace");

                var buttonSmall = document.createElement("button");
                buttonSmall.innerHTML = "Board Size 6x7"
                buttonSmall.setAttribute("onclick", "makeTable(6,7)");
                place.appendChild(buttonSmall);

                var buttonBig = document.createElement("button");
                buttonBig.innerHTML = "Board Size 8x9"
                buttonBig.setAttribute("onclick", "makeTable(8,9)");
                place.appendChild(buttonBig);
            }

            function removeTable(table){
                while(table.firstChild){
                    table.removeChild(table.firstChild);
                }
                return table;
            }

            function resetTable(){
                gameboard = [];
            }

            function createTable(row, column){
                resetTable();

                var gameRow = row;
                var gameCol = column;
            }
            
            function makeTable(Grow, Gcolumn){
                GAMEROWS = Grow;
                GAMECOL = Gcolumn;
                var table = document.createElement("table");
                
                removeTable(space); //removes preivious  table

                var tableArea = new Array(Gcolumn); 
                for(let i; i < Grow; i++){
                    table[i] = new Array(Grow);
                }
                

                for(let i = 0; i < Grow; i++){
                    var row = document.createElement("tr");
                    for(let j = 0; j < Gcolumn; j++){
                        var cell = document.createElement("td");
                        //cell.innerHTML = j
                        tablePos.push("["+String(i)+"]"+"["+String(j)+"]");
                        tableValues.push("0");
                        cell.setAttribute("id", "["+String(i)+"]"+"["+String(j)+"]");
                        cell.setAttribute("onclick", "findOpenRow(this.id)");
                        row.appendChild(cell);
                    }
                    table.appendChild(row);
                }
                if(Grow == 6 && Gcolumn == 7){
                    table.setAttribute("id", "board");
                }else{
                    table.setAttribute("id", "board2");
                }
                space.appendChild(table);
                //console.log(tableValues);
                //console.log(tablePos);
                setplayer();
            }
        </script>
    </body>
</html>